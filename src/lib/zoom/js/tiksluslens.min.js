(function(b){var a=function(e,g){var e=b(e);var o=this;var s=false;var u=false;var h=0;var q=0;var r=new Object();var l=b("body");var k={lensWidth:120,lensHeight:120,lensBackgroundColor:"#fff",lensBorderColor:"#000",showLens:false,loaderImage:"loader.gif",autoZoomRatio:false};var n=e.find("img.tiksluslens");var i=e.find("img.tiksluslens").attr("data-big-image");var x;g=b.extend(k,g);var f=function(){r.left=n.position().left;r.top=n.position().top;r.right=n.width();r.bottom=n.height();return r;};var j=function(){e.append("<div class='lens'></div>");x=e.find(".lens");if(g.showLens==true){x.css({width:g.lensWidth,height:g.lensHeight,backgroundColor:g.lensBackgroundColor,border:"1px solid",borderColor:g.lensBordercolor});}else{x.find(".lens").css({width:g.lensWidth,height:g.lensHeight,cursor:"crosshair"});}return x;};var w=function(){x.css({visibility:"hidden"});};var m=function(){x.css({visibility:"visible"});};j();var t=function(){var z=new Image();var B=f();z.src=i;var A=B.left+B.right/2;var y=B.top+B.bottom/2;if(e.find(".zoom-loading").length<=0){e.append("<div class='zoom-loading'></div>");e.find(".zoom-loading").append("<img src='"+g.loaderImage+"' border='0'>");}n.addClass("fade");e.find(".zoom-loading").css({position:"absolute",left:A+"px",top:y+"px",zIndex:1000});b("body").css("cursor","none");w();n.css({opacity:0.3});z.onload=function(){h=z.width;q=z.height;x.css({"background-image":"url('"+z.src+"')",visibility:"visible"});e.find(".zoom-loading").remove();n.removeClass("fade");b("body").css("cursor","haircross");s=true;m();n.css({opacity:1});};};var p=function(A,z){var y=f();ctop=z-g.lensHeight/2-y.top;cleft=A-g.lensWidth/2-y.left;x.css({top:z-g.lensHeight/2+"px",left:A-g.lensWidth/2+"px",visibility:"visible",width:g.lensWidth+"px",height:g.lensHeight+"px"});u=true;};var v=function(z,y){ctop=y-g.lensHeight/2;cleft=z-g.lensWidth/2;x.css({top:y-g.lensHeight/2+"px",left:z-g.lensWidth/2+"px",width:g.lensWidth+"px",height:g.lensHeight+"px"});};var d=function(){x.css({top:0,left:0,widht:0,height:0,visibility:"hidden"});l.css({cursor:"default"});};var c=function(E,D){var z=f();if(s==true&&u==true){var A=0;var y=0;y=parseFloat(h/n.width()).toFixed(1);A=parseFloat(q/n.height()).toFixed(1);y=parseFloat(h/n.width()).toFixed(1);A=parseFloat(q/n.height()).toFixed(1);var C=D-g.lensHeight/2-z.top;var B=E-g.lensWidth/2-z.left;x.css({backgroundPosition:-(B*y)+"px "+-(C*A)+"px"});if(g.autoZoomRatio==true){x.css("width",g.lensWidth*y+"px");x.css("height",g.lensHeight*A+"px");}}};n.mouseenter(function(y){if(u==false){p(y.pageX,y.pageY);}if(s==false){t();}});n.mousemove(function(y){if(u){c(y.pageX,y.pageY);v(y.pageX,y.pageY);}});x.mousemove(function(y){if(y.pageX>=n.position().left&&y.pageX<=(n.width()+n.position().left+g.lensWidth/2)&&y.pageY>=n.position().top&&(y.pageY<=n.height()+n.position().top+g.lensHeight/2)&&u==true){v(y.pageX,y.pageY);c(y.pageX,y.pageY);}else{d();l.css({cursor:"default"});u=false;}});};b.fn.tiksluslens=function(c){return this.each(function(){var d=b(this);if(d.data("tiksluslens")){return;}var e=new a(this,c);d.data("tiksluslens",e);});};})(jQuery);